# Taskel API 実装一覧

このドキュメントは、Todolisアプリの各APIの実装内容と関連するデータベーステーブルを一覧形式でまとめたものです。

## 目次

1. [スペース作成API](#スペース作成api)
2. [スペース情報取得API](#スペース情報取得api)
3. [スペース情報更新API](#スペース情報更新api)
4. [目標一覧取得API](#目標一覧取得api)
5. [目標作成API](#目標作成api)
6. [目標更新API](#目標更新api)
7. [目標削除API](#目標削除api)
8. [コメント一覧取得API](#コメント一覧取得api)
9. [コメント作成API](#コメント作成api)
10. [リアクション一覧取得API](#リアクション一覧取得api)
11. [リアクション作成API](#リアクション作成api)
12. [スペース進捗サマリー取得API](#スペース進捗サマリー取得api)

---

## スペース作成API

**エンドポイント**: `POST /api/spaces`

### やること
- 新しい目標共有スペース（グループ）を作成する
- 閲覧用・編集用のランダムトークンを生成する
- データベースにスペース情報を保存する
- 指定されたメンバーをスペースに追加する

### 使うデータテーブル
- `spaces` テーブル
- `space_members` テーブル

### インプット
- `title`: スペースのタイトル（必須、1-100文字）
- `members`: メンバー名のリスト（必須、配列形式）

### アウトプット
- `space_id`: 作成されたスペースのID（UUID）
- `view_token`: 閲覧用トークン
- `edit_token`: 編集用トークン
- `message`: 成功メッセージ

### 難易度
**初級** - 基本的なCRUD操作、トークン生成、関連データの作成

---

## スペース情報取得API

**エンドポイント**: `GET /api/spaces/{space_id}`

### やること
- 指定されたスペースの基本情報を取得する
- 閲覧用トークンの妥当性をチェックする
- スペースの存在確認を行う

### 使うデータテーブル
- `spaces` テーブル
- `space_members` テーブル

### インプット
- `space_id`: スペースID（パスパラメータ、UUID）
- `view_token`: 閲覧用トークン（クエリパラメータ）

### アウトプット
- `space`: スペース情報（ID、タイトル、作成日時、更新日時など）
- `members`: メンバー情報（名前、最終アクティブ日時など）

### 難易度
**初級** - 基本的なデータ取得、トークン認証

---

## スペース情報更新API

**エンドポイント**: `PUT /api/spaces/{space_id}`

### やること
- スペースの基本情報を更新する
- 編集用トークンの妥当性をチェックする
- 更新権限の確認を行う

### 使うデータテーブル
- `spaces` テーブル
- `space_members` テーブル

### インプット
- `space_id`: スペースID（パスパラメータ、UUID）
- `title`: スペースのタイトル（任意、1-100文字）
- `members`: メンバー名のリスト（任意、配列形式）

### アウトプット
- `space`: 更新されたスペース情報
- `message`: 成功メッセージ

### 難易度
**初級** - 基本的なデータ更新、権限チェック

---

## 目標一覧取得API

**エンドポイント**: `GET /api/goals/list/{space_id}`

### やること
- 指定されたスペース内の目標一覧を取得する
- 目標の統計情報（完了数、未完了数、達成率）を計算する
- 完了済みと未完了の目標を分類して返す

### 使うデータテーブル
- `goals` テーブル

### インプット
- `space_id`: スペースID（パスパラメータ、UUID）

### アウトプット
- `space_id`: スペースID
- `total_count`: 目標の総数
- `done_count`: 完了済みの目標数
- `todo_count`: 未完了の目標数
- `achievement_rate`: 達成率（小数点2桁）
- `done_tasks`: 完了済みの目標詳細
- `todo_tasks`: 未完了の目標詳細

### 難易度
**初級** - データ取得、集計計算、分類処理

---

## 目標作成API

**エンドポイント**: `POST /api/spaces/{space_id}/goals`

### やること
- 新しい目標を作成する
- 編集用トークンの妥当性をチェックする
- 作成権限の確認を行う
- 表示順序（order_index）を自動設定する

### 使うデータテーブル
- `goals` テーブル

### インプット
- `space_id`: スペースID（パスパラメータ、UUID）
- `title`: 目標のタイトル（必須、1-200文字）
- `detail`: 目標の詳細（任意、最大1000文字）
- `assignee`: 担当者名（任意、最大50文字）
- `due_on`: 期限日（任意、YYYY-MM-DD形式）

### アウトプット
- `goal`: 作成された目標情報
- "space_id": space_id, 
-  "task_id": タスクID

### 難易度
**初級** - データ作成、自動値設定

---

## 目標更新API

**エンドポイント**: `PUT /api/goals/{goal_id}`

### やること
- 指定された目標の情報を更新する
- 編集用トークンの妥当性をチェックする
- 更新権限の確認を行う
- ステータス変更時の特別処理を行う

### 使うデータテーブル
- `goals` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `title`: 目標のタイトル（任意、1-200文字）
- `detail`: 目標の詳細（任意、最大1000文字）
- `assignee`: 担当者名（任意、最大50文字）
- `due_on`: 期限日（任意、YYYY-MM-DD形式）

### アウトプット
- `goal`: 更新された目標情報
- "goal_id": 目標ID
- "message": 成功メッセージ

### 難易度
**初級** - データ更新、部分更新処理

---

## 目標削除API

**エンドポイント**: `DELETE /api/goals/{goal_id}`

### やること
- 指定された目標を削除する
- 編集用トークンの妥当性をチェックする
- 削除権限の確認を行う
- 関連するコメント・リアクションも削除する

### 使うデータテーブル
- `goals` テーブル
- `comments` テーブル
- `reactions` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `edit_token`: 編集用トークン（クエリパラメータ）

### アウトプット
- 204 No Content（削除成功）

### 難易度
**中級** - データ削除、関連データの処理

---

## コメント一覧取得API

**エンドポイント**: `GET /api/goals/{goal_id}/comments`

### やること
- 指定された目標へのコメント一覧を取得する
- 閲覧用トークンの妥当性をチェックする
- コメントを時系列順でソートする

### 使うデータテーブル
- `comments` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `view_token`: 閲覧用トークン（クエリパラメータ）

### アウトプット
- `comments`: コメントの配列（各コメントのID、投稿者、本文、作成日時など）

### 難易度
**初級** - データ取得、関連データの取得

---

## コメント作成API

**エンドポイント**: `POST /api/goals/{goal_id}/comments`

### やること
- 指定された目標にコメントを追加する
- 編集用トークンの妥当性をチェックする
- 作成権限の確認を行う

### 使うデータテーブル
- `comments` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `edit_token`: 編集用トークン（クエリパラメータ）
- `author`: コメント投稿者名（必須、最大50文字）
- `body`: コメント本文（必須、1-500文字）

### アウトプット
- `comment`: 作成されたコメント情報
- `message`: 成功メッセージ

### 難易度
**初級** - データ作成、関連データの作成

---

## リアクション一覧取得API

**エンドポイント**: `GET /api/goals/{goal_id}/reactions`

### やること
- 指定された目標へのリアクション一覧を取得する
- 閲覧用トークンの妥当性をチェックする
- リアクションを時系列順でソートする

### 使うデータテーブル
- `reactions` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `view_token`: 閲覧用トークン（クエリパラメータ）

### アウトプット
- `reactions`: リアクションの配列（各リアクションのID、投稿者、絵文字、作成日時など）

### 難易度
**初級** - データ取得、関連データの取得

---

## リアクション作成API

**エンドポイント**: `POST /api/goals/{goal_id}/reactions`

### やること
- 指定された目標にリアクションを追加する
- 編集用トークンの妥当性をチェックする
- 作成権限の確認を行う

### 使うデータテーブル
- `reactions` テーブル

### インプット
- `goal_id`: 目標ID（パスパラメータ、UUID）
- `edit_token`: 編集用トークン（クエリパラメータ）
- `author`: リアクションした人（必須、最大50文字）
- `emoji`: 絵文字の種類（必須、最大20文字）

### アウトプット
- `reaction`: 作成されたリアクション情報
- `message`: 成功メッセージ

### 難易度
**初級** - データ作成、関連データの作成

---

## スペース進捗サマリー取得API

**エンドポイント**: `GET /api/spaces/{space_id}/summary`

### やること
- 指定されたスペースの進捗状況や統計情報を取得する
- 閲覧用トークンの妥当性をチェックする
- 目標のステータス別集計を行う
- 完了率を計算する
- 最近のアクティビティログを取得する

### 使うデータテーブル
- `goals` テーブル
- `activity_logs` テーブル（将来実装予定）

### インプット
- `space_id`: スペースID（パスパラメータ、UUID）
- `view_token`: 閲覧用トークン（クエリパラメータ）

### アウトプット
- `summary`: 進捗サマリー（目標総数、ステータス別件数、完了率、最近のアクティビティなど）

### 難易度
**中級** - データ集計、計算処理、複数テーブルの結合

---

## 実装の段階

### 第1段階：基本的なCRUD操作（初級）
1. スペース作成API
2. スペース情報取得API
3. 目標一覧取得API
4. 目標作成API
5. 目標更新API

### 第2段階：認証・権限チェック（初級）
1. トークン検証の実装
2. 権限チェックの実装
3. エラーハンドリングの実装

### 第3段階：高度な機能（初級〜中級）
1. コメント・リアクション機能
2. 統計・サマリー機能
3. フィルタリング・ソート機能

### 第4段階：パフォーマンス最適化（中級〜上級）
1. データベースインデックスの最適化
2. キャッシュの実装
3. ページネーションの実装

## 注意事項

- 各APIは1つのタスクに集中するように設計されています
- 初学者の方は第1段階から順番に実装することをお勧めします
- データベースの外部キー制約を適切に設定してください
- トークンの生成には十分に長いランダム文字列を使用してください
- エラーハンドリングは必ず実装してください
